<!--pages/history/history.wxml-->
<view class="container">
  <view class="header-info">
    <view class="info-text">å…± {{totalRecords}} æ¡æ•°æ®ï¼Œå·²æ˜¾ç¤º {{displayedRecords}} æ¡</view>
  </view>

  <!-- å†å²æ•°æ®åˆ—è¡¨ -->
  <view class="history-list">
    <block wx:for="{{historyData}}" wx:key="period">
      <view class="history-item card">
        <view class="item-header">
          <view class="period-info">
            <text class="period-number">ç¬¬ {{item.period}} æœŸ</text>
            <t-tag theme="primary" variant="light" size="small">{{item.date}}</t-tag>
          </view>
        </view>
        
        <view class="item-numbers">
          <view class="numbers-row">
            <block wx:for="{{item.front_numbers}}" wx:key="index" wx:for-item="num">
              <view class="number-ball front">{{num}}</view>
            </block>
            <view class="number-divider">+</view>
            <block wx:for="{{item.back_numbers}}" wx:key="index" wx:for-item="num">
              <view class="number-ball back">{{num}}</view>
            </block>
          </view>
        </view>

        <!-- é”€å”®é¢å’Œå¥–æ± ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰ -->
        <view class="item-footer" wx:if="{{item.sales_amount || item.pool_balance}}">
          <view class="footer-item" wx:if="{{item.sales_amount}}">
            <text class="footer-label">é”€å”®é¢:</text>
            <text class="footer-value">{{item.sales_amount}}</text>
          </view>
          <view class="footer-item" wx:if="{{item.pool_balance}}">
            <text class="footer-label">å¥–æ± :</text>
            <text class="footer-value">{{item.pool_balance}}</text>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- åŠ è½½æ›´å¤šæŒ‰é’® -->
  <view class="load-more" wx:if="{{hasMore}}">
    <t-button 
      theme="default" 
      variant="outline" 
      block 
      loading="{{loading}}"
      bind:tap="loadMore"
    >
      {{loading ? 'åŠ è½½ä¸­...' : 'åŠ è½½æ›´å¤š (æ¯æ¬¡10æ¡)'}}
    </t-button>
  </view>

  <!-- æ²¡æœ‰æ›´å¤šæ•°æ®æç¤º -->
  <view class="no-more" wx:if="{{!hasMore && historyData.length > 0}}">
    <t-divider>å·²åŠ è½½å…¨éƒ¨æ•°æ®</t-divider>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{historyData.length === 0 && !loading}}">
    <view class="empty-icon">ğŸ“­</view>
    <view class="empty-text">æš‚æ— å†å²æ•°æ®</view>
    <view style="margin-top: 20rpx;">
      <t-button theme="primary" size="small" bind:tap="goToIndex">
        å»é¦–é¡µè·å–æ•°æ®
      </t-button>
    </view>
  </view>
</view>

<!-- Toastæç¤º -->
<t-toast id="t-toast" />
