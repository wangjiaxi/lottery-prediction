<!--pages/index/index.wxml-->
<view class="container">
  <!-- 数据状态卡片 -->
  <view class="card">
    <view class="card-title">数据状态</view>
    <t-cell-group>
      <t-cell title="数据总量" note="{{totalRecords}}条" />
      <t-cell title="最新期次" note="{{latestPeriod || '暂无'}}" />
    </t-cell-group>
    <view style="margin-top: 16rpx;">
      <t-button theme="primary" block loading="{{updatingData}}" bind:tap="updateData">
        {{updatingData ? '检查更新中...' : '检查并更新数据'}}
      </t-button>
    </view>
    <view style="font-size: 24rpx; color: #999; margin-top: 8rpx; text-align: center;">
      自动检查官方数据，如发现新数据将自动更新
    </view>
  </view>

  <!-- 号码推荐卡片 -->
  <view class="card">
    <view class="card-title">智能推荐</view>
    <view class="card-desc">选择数据范围生成推荐号码</view>
    
    <!-- 策略选择 -->
    <t-radio-group value="{{strategy}}" bind:change="onStrategyChange">
      <view style="display: flex; flex-wrap: wrap; gap: 16rpx; margin-bottom: 20rpx;">
        <t-radio label="全部数据" value="all" />
        <t-radio label="最近3年" value="3years" />
        <t-radio label="今年" value="thisYear" />
        <t-radio label="本月" value="thisMonth" />
      </view>
    </t-radio-group>

    <t-button theme="primary" variant="outline" block loading="{{generatingPredictions}}" bind:tap="generatePredictions">
      {{generatingPredictions ? '生成中...' : '生成推荐号码'}}
    </t-button>

    <!-- 推荐结果 -->
    <block wx:if="{{showRecommendations}}">
      <t-divider>热门号码</t-divider>
      <view class="numbers-row">
        <block wx:for="{{hotNumbers.front}}" wx:key="index">
          <view class="number-ball front">{{item}}</view>
        </block>
        <view class="number-divider">+</view>
        <block wx:for="{{hotNumbers.back}}" wx:key="index">
          <view class="number-ball back">{{item}}</view>
        </block>
      </view>

      <t-divider>冷门号码</t-divider>
      <view class="numbers-row">
        <block wx:for="{{coldNumbers.front}}" wx:key="index">
          <view class="number-ball front">{{item}}</view>
        </block>
        <view class="number-divider">+</view>
        <block wx:for="{{coldNumbers.back}}" wx:key="index">
          <view class="number-ball back">{{item}}</view>
        </block>
      </view>
    </block>
  </view>

  <!-- 随机选号卡片 -->
  <view class="card">
    <view class="card-title">随机选号</view>
    <view class="card-desc">系统随机生成一组号码</view>
    
    <t-button theme="success" block bind:tap="randomNumbers">
      随机生成
    </t-button>

    <block wx:if="{{showRandom}}">
      <t-divider>随机号码</t-divider>
      <view class="numbers-row">
        <block wx:for="{{randomNumbers.front}}" wx:key="index">
          <view class="number-ball front">{{item}}</view>
        </block>
        <view class="number-divider">+</view>
        <block wx:for="{{randomNumbers.back}}" wx:key="index">
          <view class="number-ball back">{{item}}</view>
        </block>
      </view>
    </block>
  </view>

  <!-- 分享功能 -->
  <view class="card">
    <view class="card-title">分享推荐</view>
    <view class="card-desc">选择分享方式</view>
    
    <view style="display: flex; gap: 16rpx; margin-bottom: 16rpx;">
      <t-button theme="warning" style="flex: 1;" bind:tap="shareImage">
        📱 微信分享
      </t-button>
      <t-button theme="primary" variant="outline" style="flex: 1;" bind:tap="shareText">
        📝 复制文字
      </t-button>
    </view>
    <view style="font-size: 24rpx; color: #999; text-align: center;">
      微信分享打开分享菜单，文字分享可粘贴到任何地方
    </view>
  </view>

  <!-- 免责声明 -->
  <view class="disclaimer">
    <view class="disclaimer-title">⚠️ 免责声明</view>
    <view class="disclaimer-text">
      本小程序提供的号码推荐仅供娱乐参考，基于历史数据的统计分析生成，不保证任何中奖概率。彩票具有随机性，请理性购彩，量力而行。
    </view>
  </view>
</view>



<!-- Toast提示 -->
<t-toast id="t-toast" />
